<%
if (scaffoldLite) {
%>
    <%= inlineLiteJs %>
<%
} else {
%>
    <div class="footer"><div class="footer--logo"></div></div>
    <script>
        var browserType = null;

        if ('querySelector' in document && 'localStorage' in window && 'addEventListener' in window) {
            browserType = 'html5';
        }
        else if (document.documentMode && (document.documentMode < 9)) {
            browserType = 'legacyie';
        }

        if (browserType) {
            var debugMode = setDebugMode(),
                settings  = getSettings(browserType, debugMode),
                done      = false,
                script    = document.createElement('script');
            script.src = "<%= pathStatic %>/<%= language %>/js/lib/vendors/require/require-2.1.0.js";
            script.type = "text/javascript";
            script.onload = script.onreadystatechange = function() {
                if ( !done && (!this.readyState || this.readyState === "loaded" || this.readyState === "complete") ) {
                    done = true;
                    require.config(settings.requireConfig);
                    require([settings.moduleToStartApp], function () {
                        require(['app-<%= language %>'], function (app) {});
                    });
                }
            }
            document.body.appendChild(script);
        }

        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        function setDebugMode() {
            var debugForced = window.location.href.match(/debug=true/);
            if (debugForced) {
                return true;
            }
            return <%= debug %>;
        }

        function getSettings(browserType, debug) {
            var config = {
                    urlArgs: "v=<%= version %>",
                    baseUrl: "<%= pathStatic %>/<%= language %>/js/",
                    waitSeconds: 20
                },
                moduleToStartApp = '<%= pathStatic %>/<%= language %>/js/all-<%= language %>-'+browserType+'.js';

            if (debug) {
                var jqueryVersion   = (browserType === 'html5') ? 'jquery-2.0.3' : 'jquery-1.9.1';
                config.paths        = <%= amdModulePaths %>;
                config.paths.jquery = './lib/vendors/jquery/' + jqueryVersion;
                config.paths.app    = './app-<%= language %>';
                moduleToStartApp    = '<%= pathStatic %>/<%= language %>/js/app.js';
            }
            config.paths = config.paths || {};
            config.paths.d3 = 'lib/vendors/d3/d3.min';
            return {
                requireConfig: config,
                moduleToStartApp: moduleToStartApp
            };
        }
    </script>
<%
}
%>
</body>
</html>